<div dir="rtl">

# 🎮 שדרוגי משחק – מטלה: בניית עולם ואלגוריתמים בשני ממדים - חלק א במטלה שבועית 

בקובץ זה מתוארים ארבעת השינויים שבוצעו במשחק, כפי שנדרש במטלה, כולל שימוש במכונת המצבים ליצירת התנהגויות מעניינות יותר לשחקן ולאויבים (סעיף ג).
המטרה : להגיע לטירה שנמצאת במים 

קישור למשחק בitch.io חלק 1 :  
https://alpha444rt.itch.io/part1weeklyassigment
על מנת לשחקן צריך להשתמש בארבעת החיצים .
---

## ✨ שינוי 1: הוספת בלון פורח  יכולת חד־פעמית למעבר מעל הרים

הוספנו למשחק אריח חדש של **כדור פורח**.  
כאשר השחקן דורך על האריח:

- הוא מקבל יכולת לעבור מעל הרים שבאים אחד אחר השני, אפשרות שלא הייתה קיימת מראש.  
- היכולת היא **חד־פעמית** – ברגע שהשחקן יורד ממשבצת הר כלומר דורך על אריח חוקי , היכולת נעלמת בנוסף לכך יש שתי אפשריות לאיסוף כדור פורח .  
- אריח הבלון מוחלף לאריח אחר שבעצם הוא אריח מכשול כלומר אי אפשר לעבור דרכו  .

שינוי זה מוסיף לשחקן אפשרויות תכנון מסלול וממד אסטרטגי חדש.

---
## ✨ שינוי 2: הוספת סירה – תנועה במים והגעה לטירה

נוספה סירה על קו החוף המאפשרת לשחקן להפליג:

- כאשר השחקן דורך על הסירה הוא נכנס למצב "שייט".  
- במצב זה ניתן לנוע על פני כל אזורי המים.  
- כל אריח מים שהשחקן דורך עליו הופך ל"שביל סירה" ליצירת מסלול ברור.  
- הטירה (Castle) נגישה רק דרך המים.  
- כאשר השחקן מגיע לטירה בזמן שייט — מופעל מצב ניצחון והתנועה נעצרת.
שינוי זה מוסיף אתגר ומאלץ את השחקן להשתמש בסירה כדי להגיע ליעד.

---

## ✨ שינוי 3: אויב כחול – התנגשות שמחזירה לנקודת ההתחלה

האויב הכחול מקבל יכולת לפגוע בשחקן:

- כאשר השחקן מתנגש בו — השחקן מוחזר לנקודת ההתחלה שלו.  
- תוספת זו יוצרת איום בסיסי במשחק ומחייבת תכנון זהיר של התנועה.

---

## ✨ שינוי 4: אויב ירוק – התנהגות חכמה המגינה על הסירה

האויב הירוק מקבל לוגיקת AI מתקדמת המבוססת על מכונת מצבים:

- במצב רגיל (Idle) הוא עומד ואינו מגיב.  
- כאשר השחקן מתקרב לאזור הסירה — האויב נכנס למצב "הגנה על הסירה".  
- במצב זה הוא נע לעמדה אסטרטגית בין השחקן לבין הסירה במטרה לחסום גישה.  
- האויב **אינו יכול לדרוך על מים**, ולכן לפני כל תנועה הוא בודק אם האריח הבא הוא מים.  
- אם האויב הירוק מתנגש בשחקן — הוא מחזיר אותו לנקודת ההתחלה.

שינוי זה יוצר אתגר חכם ודינמיקה חדשה במשחק.

---

# 🧠 שימוש במכונת המצבים (FSM)

בפרויקט זה נעשה שימוש במכונת המצבים שסופקה עם המטלה כדי לנהל מצבי התנהגות מורכבים:

### ✔ אצל השחקן:
- **מצב משחק רגיל (Playing)** – תנועה במפה, איסוף בלון, עלייה לסירה ושייט.  
- **מצב ניצחון (Win)** – מופעל כאשר השחקן מגיע לטירה; המשחק מסתיים.



### ✔ אצל האויב הירוק:
- האויב עומד במקום מצב שנקרא (Idle).  
-  מופעל כאשר השחקן מתקרב לסירה; האויב נע לעמדת הגנה מצב שנקרא (DefendBoat).



ה־FSM מאפשרת להפריד בין התנהגויות שונות בצורה ברורה, נקייה ומודולרית.

---

# ✔ סיכום

במשחק נוספו ארבע התנהגויות מרכזיות המשדרגות את חוויית המשחק:

1. **בלון פורח** – מעבר חד־פעמי מעל הרים.  
2. **סירה** – תנועה במים, יצירת שביל והגעה לטירה.  
3. **אויב כחול** – החזרת השחקן להתחלה בהתנגשות.  
4. **אויב ירוק** – הגנה על הסירה באמצעות FSM והתנגשות שמחזירה להתחלה.

שינויים אלו מוסיפים עומק, אסטרטגיה ודינמיקה חדשה למשחק ועומדים באופן מלא בדרישות סעיף ג׳ במטלה.

# Assignment 2.b
**Scene used:** `d-tilemap-100-player.unity`

--- 
### קישור לאתר itch: 
https://alpha444rt.itch.io/week6part2b

---

במטלה זו הוספנו בדיקה שמוודאת שהשחקן ממוקם רק על אריח שממנו ניתן להגיע ל־**100 אריחים נגישים לפחות** בעזרת BFS.

---


###  1. BFS Reachability  
בקובץ `BFS.cs` הוספנו פונקציה חדשה:

#### `CountReachableNodes()`
- מקבלת גרף של אריחים ונקודת התחלה.
- מבצעת חיפוש BFS.
- סופרת כמה אריחים ניתנים להגעה.
- משמשת לקביעה האם מיקום השחקן חוקי לפתיחה.

---

###  2. Player Placement Logic in TilemapCaveGenerator  
בקובץ `TilemapCaveGenerator.cs` בוצעו השינויים הבאים:

- הוספנו שדה `playerTransform` להצבת השחקן.
- הוספנו משתנה `minReachableTiles = 100`.
- קליטה של `allowedTiles` לבניית גרף אריחים.
- יצירת גרף `TilemapGraph` עבור BFS.
- הוספנו את הפונקציה:  
  **`ValidateAndPlacePlayer()`**

הפונקציה מבצעת:

1. אוספת את כל האריחים שניתן לדרוך עליהם.
2. בוחרת נקודות התחלה אקראיות.
3. מפעילה BFS על כל נקודה.
4. בודקת אם יש ≥ 100 אריחים שניתנים להגעה.
5. אם כן — מציבה שם את השחקן.
6. אם לא — מנסה שוב עד שנמצא מיקום תקין.
7. אם לא נמצאה נקודה טובה אחרי מספר ניסיונות — מציבה נקודה אקראית ומדפיסה אזהרה.

---

## Console Log Output

המערכת מדפיסה ביומן את כל ניסיונות החיפוש. דוגמה:
Found valid spawn point at (34,27,0).
Reachable tiles: 145 after 4 attempts.

---
 ## בדיקות יחידה
בדיקות היחידה בוצעו ביישום קונסול מופשט (Console Application) על גרף דמה (MockGraph), בהתאם לדרישות המטלה, כדי לוודא את נכונות האלגוריתם BFS.CountReachableNodes לפני שילובו במנוע Unity. הבדיקות אימתו את הפונקציונליות המרכזית של האלגוריתם: ספירת הצמתים הנגישים מנקודת התחלה נתונה. נבדקו שלושה תרחישים עיקריים: (1) אזור מחובר גדול (אימות ספירה נכונה של כל הרשת), (2) אזור מבודד קטן (אימות שהספירה אינה כוללת צמתים מנותקים), ו-(3) צומת התחלה שאינו מחובר לאף שכן, שמוכיח שהאלגוריתם מחזיר את גודל הקומפוננטה המקושרת באופן מדויק.



</div>
